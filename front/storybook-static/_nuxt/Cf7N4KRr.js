import{_ as Q}from"./CoeiA8Mv.js";import{_ as M}from"./CADcuymq.js";import{a as O,b as $,_ as q,u as G,c as W}from"./BHjTxwOp.js";import{_ as J}from"./Dv_JhIDu.js";import{_ as Y,a as Z}from"./BVajuloz.js";import{_ as ee}from"./CxP1Mprn.js";import{f as h,C as L,U as te,A as oe,D as ne,_ as se,E as ae}from"./DYmndyt5.js";import{d as V,r as A,H as X,W as I,v as b,x as m,y as c,O as U,B as a,s as e,C as F,E as P,z as R,F as j,Q as g,R as w,P as le,S as re,T as ue,U as me,D as de,A as _e}from"./BhoS_8da.js";import{l as ie}from"./BFXwtwrJ.js";import{u as k}from"./CmDf-aGC.js";import{_ as ce,a as pe}from"./B-u76wg8.js";import{u as Te}from"./O1MeW6Fz.js";import{u as fe}from"./Dl3A-_vs.js";import"./CE40bwFq.js";import"./BhLkZZtO.js";import"./PPVm8Dsz.js";import"./Cpj98o6Y.js";const Ee={key:1,class:"flex items-start gap-2 flex-col sm:flex-row sm:items-center"},ve={class:"flex gap-2"},H=V({__name:"StatusCard",props:{status:{}},emits:["onDelete","onUpdate"],setup(d,{emit:T}){const _=d,f=T,{validationErrors:C,clearErrorMessages:p}=k(),l=A(!1),r=A(!1),E=ie.cloneDeep(_.status.name),i=[{icon:"pen",iconColor:"secondary",label:"編集",event:()=>{r.value=!r.value}},{icon:"trash",iconColor:"error",label:"削除",event:()=>{f("onDelete",_.status.id)}}];return X(r,o=>{p(),o?(l.value=!1,I(()=>{h(".status-update")})):_.status.name=E}),(o,t)=>{const u=M,n=O,v=$,x=J,y=Z,B=Y,D=ee;return m(),b(D,{class:"flex items-center justify-between p-4"},{default:c(()=>[e(r)?(m(),U("div",Ee,[a(n,{modelValue:d.status.name,"onUpdate:modelValue":t[0]||(t[0]=s=>d.status.name=s),placeholder:"ステータス名を入力",class:"status-update","error-message":e(C)["update-status.name"]},null,8,["modelValue","error-message"]),R("div",ve,[a(v,{text:"CANCEL_BUTTON_TEXT"in o?o.CANCEL_BUTTON_TEXT:e(L),color:"secondary",class:"flex-shrink-0",onClick:t[1]||(t[1]=s=>r.value=!1)},null,8,["text"]),a(v,{text:"UPDATE_BUTTON_TEXT"in o?o.UPDATE_BUTTON_TEXT:e(te),class:"flex-shrink-0",onClick:t[2]||(t[2]=s=>f("onUpdate",d.status.id,d.status))},null,8,["text"])])])):(m(),b(u,{key:0},{default:c(()=>[F(P(d.status.name),1)]),_:1})),a(B,{modelValue:e(l),"onUpdate:modelValue":t[5]||(t[5]=s=>j(l)?l.value=s:null)},{trigger:c(()=>[d.status.is_updatable?(m(),b(x,{key:0,icon:"ellipsis","is-clickable":"",onClick:t[3]||(t[3]=s=>l.value=!e(l)),onKeydown:t[4]||(t[4]=re(s=>l.value=!e(l),["enter"]))})):le("",!0)]),contents:c(()=>[(m(),U(g,null,w(i,s=>a(y,{key:s.label,icon:s.icon,"icon-color":s.iconColor,label:s.label,event:s.event},null,8,["icon","icon-color","label","event"])),64))]),_:1},8,["modelValue"])]),_:1})}}}),xe=Object.assign(H,{__name:"StatusCard"});H.__docgenInfo={exportName:"default",displayName:"StatusCard",description:"",tags:{},props:[{name:"status",required:!0,type:{name:"Status"}}],events:[{name:"onDelete",type:{names:["number"]}},{name:"onUpdate",type:{names:["number"]}}],sourceFiles:["/var/www/html/app/components/StatusCard.vue"]};const z=V({__name:"AddStatusModal",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:ue(["submit"],["update:modelValue"]),setup(d,{emit:T}){const _=me(d,"modelValue"),f=T,{validationErrors:C,clearErrorMessages:p}=k(),{user:l}=de(),r=A({name:"",order:0,user_id:l.id}),E=()=>{f("submit",r.value)};return X(_,i=>{p(),r.value.name="",i&&I(()=>{h("#add-status-modal__input")})}),(i,o)=>{const t=O,u=q,n=$,v=ce;return m(),b(v,{modelValue:_.value,"onUpdate:modelValue":o[2]||(o[2]=x=>_.value=x),title:"ステータスを追加する"},{content:c(()=>[R("form",{onSubmit:_e(E,["prevent"])},[a(u,{label:"ステータス名","has-border":!1},{default:c(()=>[a(t,{modelValue:e(r).name,"onUpdate:modelValue":o[0]||(o[0]=x=>e(r).name=x),placeholder:"ステータス名を入力",id:"add-status-modal__input","error-message":e(C)["add-status.name"]},null,8,["modelValue","error-message"])]),_:1})],32)]),footer:c(()=>[a(n,{text:"CANCEL_BUTTON_TEXT"in i?i.CANCEL_BUTTON_TEXT:e(L),color:"secondary",onClick:o[1]||(o[1]=x=>_.value=!1)},null,8,["text"]),a(n,{text:"ADD_BUTTON_TEXT"in i?i.ADD_BUTTON_TEXT:e(oe),onClick:E},null,8,["text"])]),_:1},8,["modelValue"])}}}),Se=Object.assign(z,{__name:"AddStatusModal"});z.__docgenInfo={exportName:"default",displayName:"AddStatusModal",description:"",tags:{},events:[{name:"submit",type:{names:["TSTypeQuery"]}}],sourceFiles:["/var/www/html/app/components/AddStatusModal.vue"]};const N="ステータス設定",Ce=V({__name:"index",setup(d){G({title:N});const{showSnackbar:T}=Te(),{useCustomFetch:_,callApi:f}=fe(),{setErrorMessages:C}=k(),p=A(!1),{data:l,pending:r,refresh:E}=_("/statuses"),i=u=>{f("/statuses",{method:"POST",body:u}).then(()=>{p.value=!1,T("ステータスを追加しました"),E()}).catch(n=>{C(n.data.errorMessage,"add-status")})},o=(u,n)=>{f(`/statuses/${u}`,{method:"PUT",body:n}).then(()=>{T("ステータスを更新しました"),E()}).catch(v=>{C(v.data.errorMessage,"update-status")})},t=u=>{f(`/statuses/${u}`,{method:"DELETE"}).then(()=>{T("ステータスを削除しました"),E()}).catch(()=>{T(ae,"error")})};return(u,n)=>{const v=Q,x=M,y=xe,B=se,D=W,s=pe,K=Se;return m(),U(g,null,[a(D,null,{default:c(()=>[a(v,{title:N,breadcrumb:[{label:N}],"has-data-length":!1},null,8,["breadcrumb"]),a(x,{color:"secondary",size:"small"},{default:c(()=>[(m(!0),U(g,null,w(Object.values("DEFAULT_STATUSES"in u?u.DEFAULT_STATUSES:e(ne)),S=>(m(),U("span",{key:S.value},"「"+P(S.label)+"」",1))),128)),n[2]||(n[2]=F(" は変更・削除できません。 ",-1))]),_:1}),a(B,{pending:e(r),"data-length":e(l)?.length||0},{default:c(()=>[(m(!0),U(g,null,w(e(l),S=>(m(),b(y,{key:S.id,status:S,onOnDelete:t,onOnUpdate:o},null,8,["status"]))),128))]),_:1},8,["pending","data-length"])]),_:1}),a(s,{onClick:n[0]||(n[0]=S=>p.value=!0)}),a(K,{modelValue:e(p),"onUpdate:modelValue":n[1]||(n[1]=S=>j(p)?p.value=S:null),onSubmit:i},null,8,["modelValue"])],64)}}});Ce.__docgenInfo={exportName:"default",displayName:"status",description:"",tags:{},sourceFiles:["/var/www/html/app/pages/status/index.vue"]};export{Ce as default};
